#!upstart
description "square-cube evaluator server"
author "Nick Howell"

start on started mongodb
stop on shutdown

script
        echo $$ > /var/run/square-cube-eval.pid
        chdir /data/square-cube/cube/
        exec /usr/bin/node bin/redgate_evaluator.js >> /var/log/square-cube-eval.log 2>&1
        respawn
end script

pre-start script
        # Date format same as (new Date()).toISOString() for consistency
        echo "[`date -u +%Y-%m-%dT%T.%3NZ`] (sys) Starting" >> /var/log/square-cube-eval.log
end script

pre-stop script
        rm /var/run/square-cube.pid
        echo "[`date -u +%Y-%m-%dT%T.%3NZ`] (sys) Stopping" >> /var/log/square-cube-eval.log
end script
